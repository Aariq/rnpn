<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>07. Putting It All Together • rnpn</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="07. Putting It All Together">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rnpn</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01_introduction.html">01. Introduction to National Phenology Network Observational Data</a>
    </li>
    <li>
      <a href="../articles/02_status_intensity.html">02. Status and Intensity Data</a>
    </li>
    <li>
      <a href="../articles/03_individual_phenometrics.html">03. Individual Phenometrics</a>
    </li>
    <li>
      <a href="../articles/04_site_phenometrics.html">04. Site Phenometrics</a>
    </li>
    <li>
      <a href="../articles/05_magnitude_phenometrics.html">05. Magnitude Phenometrics</a>
    </li>
    <li>
      <a href="../articles/06_geospatial.html">06. USA-NPN Geospatial Data</a>
    </li>
    <li>
      <a href="../articles/07_combine_raster_point.html">07. Putting It All Together</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>07. Putting It All Together</h1>
                        <h4 class="author">Lee Marsh</h4>
            
            <h4 class="date">2019-10-25</h4>
      
      
      <div class="hidden name"><code>07_combine_raster_point.Rmd</code></div>

    </div>

    
    
<div id="combine-point-and-raster-data" class="section level2">
<h2 class="hasAnchor">
<a href="#combine-point-and-raster-data" class="anchor"></a>Combine Point and Raster Data</h2>
<p>Observational and gridded data can be visualized or analyzed together for a variety of purposes. Users may want to identify spatial patterns in the alignment of dogwood bloom and the Spring Index bloom model. The current year’s lilac leaf out observations may be compared to the 30 year average lilac sub-model of the spring index to see how well the model predicts the observations.</p>
<p>This example shows several data access calls to assemble observational and gridded data.</p>
<p>Option 1: You can add a parameter to an observational data call to additionally get a gridded layer value for each observation location/date. Note that if you don’t specify which sub model of the Spring Index you want, you will get the SI-x Average layers.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="../reference/npn_download_site_phenometrics.html">npn_download_site_phenometrics</a></span>(</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  <span class="dt">request_source =</span> <span class="st">'Your Name Here'</span>, </a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  <span class="dt">years =</span> <span class="st">'2013'</span>,</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="dt">num_days_quality_filter =</span> <span class="st">'30'</span>, </a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  <span class="dt">species_ids =</span> <span class="st">'35'</span>,</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">  <span class="dt">phenophase_ids =</span> <span class="st">'373'</span>, </a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  <span class="dt">download_path =</span> <span class="st">'cl_lilac_data_2013_SIxLeaf.csv'</span>,</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  <span class="dt">six_leaf_layer =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  <span class="dt">six_sub_model =</span> <span class="st">'lilac'</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">)</a></code></pre></div>
<p>If you want to append raster data other than Spring Index, Leaf values, there’s alternative boolean flags that can be set, including six_bloom_layer for Spring Index, Bloom data, and agdd_layer. Instead of TRUE or FALSE agdd_layer takes 32 or 50 and will correlate each data point with the corresponding AGDD value for the given date using either 32 or 50 base temperature.</p>
<p>Option 2: You can create a combined plot of observational data with modeled/raster data.</p>
<p>Building on the approach for accessing point data from earlier vignettes describing Individual Phenometrics and getting raster data, we can access and plot these products together. In this example, we will look at how well cloned lilac leaf out observations in 2018 are predicted by the lilac leaf sub model of the Spring Index.</p>
<div id="step-1-get-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#step-1-get-the-data" class="anchor"></a>Step 1: Get the data</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">LilacLeaf2018&lt;-<span class="kw"><a href="../reference/npn_download_geospatial.html">npn_download_geospatial</a></span>(</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="st">'si-x:lilac_leaf_ncep'</span>, </a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="st">'2018-12-31'</span>, </a>
<a class="sourceLine" id="cb2-4" data-line-number="4">)</a></code></pre></div>
<pre><code>## [1] "https://geoserver.usanpn.org/geoserver/wcs?service=WCS&amp;version=2.0.1&amp;request=GetCoverage&amp;format=geotiff&amp;coverageId=si-x:lilac_leaf_ncep&amp;SUBSET=time(\"2018-12-31T00:00:00.000Z\")"</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">LilacLeaf2018Obs &lt;-<span class="kw"><a href="../reference/npn_download_individual_phenometrics.html">npn_download_individual_phenometrics</a></span>(</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">  <span class="dt">request_source =</span> <span class="st">'Your Name Here'</span>, </a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  <span class="dt">years =</span> <span class="st">'2018'</span>,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">  <span class="dt">species_ids =</span> <span class="st">'35'</span>,</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  <span class="dt">phenophase_ids =</span> <span class="st">'373'</span> </a>
<a class="sourceLine" id="cb4-6" data-line-number="6">)</a></code></pre></div>
</div>
<div id="step-2-preparing-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#step-2-preparing-the-data" class="anchor"></a>Step 2: Preparing the data</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">coords &lt;-<span class="st"> </span>LilacLeaf2018Obs[ , <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>)]</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(LilacLeaf2018Obs<span class="op">$</span>first_yes_doy)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">crs &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">"+proj=utm +zone=18 +datum=WGS84 +units=m +no_defs </span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="st">                 +ellps=WGS84 +towgs84=0,0,0"</span>)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">LL_spdf &lt;-<span class="st"> </span><span class="kw">SpatialPointsDataFrame</span>(</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">  <span class="dt">coords =</span> coords,</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">  <span class="dt">data =</span> data, </a>
<a class="sourceLine" id="cb5-10" data-line-number="10">  <span class="dt">proj4string =</span> crs</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">)</a></code></pre></div>
</div>
<div id="step-3-define-style-options-and-create-graph" class="section level3">
<h3 class="hasAnchor">
<a href="#step-3-define-style-options-and-create-graph" class="anchor"></a>Step 3: Define style options and create graph</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">my.palette &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dt">n=</span><span class="dv">9</span>,<span class="dt">name=</span><span class="st">"OrRd"</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  LilacLeaf2018, </a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="dt">col =</span> my.palette,</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  <span class="dt">main=</span><span class="st">"2018 Observed and Predicted Lilac Leaf Out"</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  LL_spdf,</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">  <span class="dt">main=</span><span class="st">"Lilac Obs"</span>,</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">  <span class="dt">pch =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb6-13" data-line-number="13">  <span class="dt">bg =</span> my.palette,</a>
<a class="sourceLine" id="cb6-14" data-line-number="14">  <span class="dt">col =</span> <span class="st">'black'</span>,</a>
<a class="sourceLine" id="cb6-15" data-line-number="15">  <span class="dt">xlim=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="fl">125.0208</span>,<span class="op">-</span><span class="fl">66.47917</span>),</a>
<a class="sourceLine" id="cb6-16" data-line-number="16">  <span class="dt">ylim=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">24.0625</span> ,<span class="fl">49.9375</span>),</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">  <span class="dt">add =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18">)</a>
<a class="sourceLine" id="cb6-19" data-line-number="19"></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/legend">legend</a></span>(</a>
<a class="sourceLine" id="cb6-21" data-line-number="21">  <span class="st">"bottomright"</span>, </a>
<a class="sourceLine" id="cb6-22" data-line-number="22">  <span class="dt">legend=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Cloned Lilac Leaf Out Observations"</span>),</a>
<a class="sourceLine" id="cb6-23" data-line-number="23">  <span class="dt">pch =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb6-24" data-line-number="24">  <span class="dt">bg =</span> <span class="st">'white'</span>,</a>
<a class="sourceLine" id="cb6-25" data-line-number="25">  <span class="dt">col =</span> <span class="st">'black'</span>,</a>
<a class="sourceLine" id="cb6-26" data-line-number="26">  <span class="dt">bty=</span><span class="st">"n"</span>, </a>
<a class="sourceLine" id="cb6-27" data-line-number="27">  <span class="dt">cex=</span>.<span class="dv">8</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28">)</a></code></pre></div>
<p><img src="07_combine_raster_point_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#combine-point-and-raster-data">Combine Point and Raster Data</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Scott Chamberlain, Lee Marsh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
